(function(g){g(document).ready(function(){function m(k){var a={};a.select=k;a.is_start=!1;a.inArray=function(a,c){for(var b=a.length-1;0<=b;b--)if(a[b]==c)return!0;return!1};a.clearText=function(a){a=a.replace(/\(\d+\)$/g,"");return a.replace(/^\s+|\s+$/g,"")};a.getOptions=function(d){for(var c=[],b=d.length-1;0<=b;b--){var f=a.clearText(g(d[b]).text());a.inArray(c,f)||c.push(f)}return c};a.createTags=function(){for(var d=a.selected_options.length-1;0<=d;d--)a.ul.tagit("createTag",a.selected_options[d])};
a.changeTags=function(){for(var d=a.getOptions(a.select.children("option:selected")),c=a.ul.tagit("assignedTags"),b=c.length-1;0<=b;b--)a.inArray(d,c[b])||a.ul.tagit("removeTagByLabel",c[b]);for(b=d.length-1;0<=b;b--)a.inArray(c,d[b])||a.ul.tagit("createTag",d[b])};a.addSelected=function(d,c){a.inArray(d,a.clearText(c.text()))&&c.attr("selected",!0)};a.removeSelected=function(d,c){a.inArray(d,a.clearText(c.text()))||c.attr("selected",!1)};a.changeSelected=function(d,c){for(var b=a.select.children("option"),
f=b.length-1;0<=f;f--)c(d,g(b[f]))};a.all_options=a.getOptions(k.children("option"));a.selected_options=a.getOptions(k.children("option:selected"));a.ul=g("<ul></ul>");k.before(a.ul);a.select.change(function(){a.changeTags()});a.start=function(){a.createTags();a.is_start=!0};return a}function n(k){var a=m(k);a.is_add=a.select.attr("is_add")?a.select.attr("is_add"):!0;a.ajaxAddTag=function(d){var c=a.select.attr("controller");if(c){var b=a.select.attr("action")?a.select.attr("action"):"create",f=a.select.attr("param")?
a.select.attr("param"):"title",b="/"+(a.select.attr("controllers")?a.select.attr("controllers"):c+"s")+"/"+b,e={};e[c+"["+f+"]"]=d;g.ajax({url:b,dataType:"json",type:"POST",data:e,success:function(a){a?k.prepend('<option selected="selected" value="'+a.id+'">'+d+"</option>"):console.log("josn is null")}})}else console.log("select's controller param is null")};a.ul.tagit({allowSpaces:!0,availableTags:a.all_options,afterTagAdded:function(d,c){var b=c.tagLabel;all_options=a.getOptions(a.select.children("option"));
a.ul.parents(".control-group").removeClass("error");a.inArray(all_options,b)?a.changeSelected(a.ul.tagit("assignedTags"),a.addSelected):!0===a.is_add?a.ajaxAddTag(b):(a.ul.tagit("removeTagByLabel",b),a.ul.parents(".control-group").addClass("error"))},afterTagRemoved:function(d,c){a.changeSelected(a.ul.tagit("assignedTags"),a.removeSelected)}});return a}function p(e){var a=m(e);a.ul.tagit({allowSpaces:!0,availableTags:a.all_options,tagLimit:1,afterTagAdded:function(d,c){var b=c.tagLabel;all_options=
a.getOptions(a.select.children("option"));if(a.inArray(all_options,b)){a.changeSelected(a.ul.tagit("assignedTags"),a.addSelected);var f=g(e.children("option:selected")[0]).val(),h=g("#careers_"+f).attr("nil_params");""==h?(a.ul.parents(".control-group").removeClass("error"),a.ul.parents(".control-group").addClass("success"),a.ul.parents(".control-group").find(".help-inline").html('Success! <a href="/careers/'+f+'/edit">Edit '+b+"</a>")):a.ul.parents(".control-group").find(".help-inline").html(h+' <a href="/careers/'+
f+'/edit">Edit '+b+"</a>")}else a.ul.tagit("removeAll"),a.ul.parents(".control-group").removeClass("success"),a.ul.parents(".control-group").addClass("error"),a.ul.parents(".control-group").find(".help-inline").text("You should choice one career.");1==a.ul.tagit("assignedTags").length&&(a.ul.find(".ui-autocomplete-input").attr("disabled","disabled"),!0===a.is_start&&a.select.focus())},afterTagRemoved:function(d,c){a.changeSelected(a.ul.tagit("assignedTags"),a.removeSelected);1>a.ul.tagit("assignedTags").length&&
a.ul.find(".ui-autocomplete-input").removeAttr("disabled")}});return a}for(var h=g(".smart_tag"),e=h.length-1;0<=e;e--){var l=n(g(h[e]));l.start()}h=g(".single_choice");for(e=h.length-1;0<=e;e--)l=p(g(h[e])),l.start()})})(window.jQuery);